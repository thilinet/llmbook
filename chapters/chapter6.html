
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 6 - Prompt Engineering &#8212; Learn Large Language Models Fast</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/chapter6';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 8 - LLM Agents Development Ecosystem" href="chapter8.html" />
    <link rel="prev" title="Chapter 3 - Pre-train a tiny LLM" href="chapter3/chapter3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/llm_t.png" class="logo__image only-light" alt="Learn Large Language Models Fast - Home"/>
    <script>document.write(`<img src="../_static/llm_t.png" class="logo__image only-dark" alt="Learn Large Language Models Fast - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Learn Large Language Models Fast
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1/chapter1.html">Chapter 1 - Input to LLMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2/chapter2.html">Chapter 2 - Transformer Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter3/chapter3.html">Chapter 3 - Pre-train a tiny LLM</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 6 - Prompt Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8.html">Chapter 8 - LLM Agents Development Ecosystem</a></li>


<li class="toctree-l1"><a class="reference internal" href="chapter9.html">Chapter 7 - Rag based applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter10.html">Chapter 10- Artificial General Intelligence</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/chapter6.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 6 - Prompt Engineering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-prompting">Why prompting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-context-learning">In-context learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-shot">Zero Shot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#few-shot">Few Shot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithimical-optimization-of-llm-prompts">Algorithimical Optimization of LLM Prompts</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-6-prompt-engineering">
<h1>Chapter 6 - Prompt Engineering<a class="headerlink" href="#chapter-6-prompt-engineering" title="Link to this heading">#</a></h1>
<p>Unlike other computer programs, where we interact with source code, LLM interactions is through text. The input text we provide to LLM is called as Prompt. Different LLMs are trained to take different length of input tokens. This is called as context window/length. GPT-2.5 Turbo has a context length of 16K. GPT-4 on the ohter hand can ingest upto 128K tokens. Using this prompt the language models makes an inference. The process of deriving the ouptut based on the inference is called as completion.</p>
<p>A typical prompt is composed of the following elements</p>
<ul class="simple">
<li><p>A question or an instruction to the language model</p></li>
<li><p>Context information</p></li>
<li><p>Any other examples</p></li>
</ul>
<p>We will begin this chapter with introductions history of prompt and prompt engineering. Prompt engineering is a discipline to help us adapt LLMs for diverse tasks. This is a new paradigm in machine learning. Historically, models were trained to perform a single task restiricted to a single domain. Prompt engineering enables us to use a pre-trained language model adapt itself to perform different tasks. We will intially look at the foundational techniques like zero-shot and few-shot learning. For the purpose of demonstration, we will leverage LangChain PromptTemplates and Ollama models.Post pre-training, during instruction fine tuning phase, models get trained to perform multiple tasks through instruction datasets. Hence they may have different prompting syntax. LangChain provides us with an unified way of interacting with different models.</p>
<section id="why-prompting">
<h2>Why prompting<a class="headerlink" href="#why-prompting" title="Link to this heading">#</a></h2>
<p>Today’s software market demands a variety of NLP systems. Starting from grammatical correction, text summariziation, question answering, plaguraism detection, language transalation, sentiment analysis, text classification, and many more. Data collection and labeling for each of these tasks are manual labour intensive. Once a system is developed and deployed, the whole process has to be repeated for creating another system. Even if the other system is not drastically different than the former one.</p>
<p>A complex model, when trained with a limited dataset is prone to exploit spurious correlations in the training dataset. Consider the case of a large language models. These models are pre-trained with billions of tokens. However while fine tuning for a specific task, the training data is very limited, in order of magnitude much smaller than the initial data used for pre-training.</p>
<p>With a few examples humans can learn new NLP tasks. They don’t need to be provided with large amount of traning data. A task speciiced in natrual language, along with a couple of examples is suffiecient.</p>
<section id="in-context-learning">
<h3>In-context learning<a class="headerlink" href="#in-context-learning" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_community.llms</span> <span class="kn">import</span> <span class="n">Ollama</span>

<span class="n">MODEL</span> <span class="o">=</span> <span class="s2">&quot;phi3:latest&quot;</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">Ollama</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">MODEL</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">langchain_community.llms</span> <span class="kn">import</span> <span class="n">Ollama</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s2">&quot;phi3:latest&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">llm</span> <span class="o">=</span> <span class="n">Ollama</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">MODEL</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;langchain_community&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt1</span> <span class="o">=</span> <span class="s2">&quot;Will cotton sink in water&quot;</span>
<span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">prompt1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;Yes, cotton will generally float on the surface of water. This is because cotton fibers are light and have a low density compared to water. Cotton&#39;s ability to absorb water can also increase its overall volume without significantly increasing its mass, which further contributes to it floating rather than sinking when placed in water. However, if enough cotton becomes submerged due to absorption of water and the weight increases beyond a certain point, then at that moment, it would start to sink, but typically this happens after significant soaking.&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="s2">&quot;will </span><span class="si">{item}</span><span class="s2"> sink in water?&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">prompt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="s2">&quot;cotton&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Yes, cotton will generally sink in water. Cotton is a natural fiber that is not very dense compared to most materials commonly found in nature or manufactured products. However, it&#39;s important to note that the amount of cotton and how it&#39;s packed together can affect whether it sinks or floats. If you have a large quantity of loose cotton fibers, they may disperse and float on water due to their low density and surface tension effects. But typically, when considering an individual piece of cotton fabric in still water, it will sink because the overall density is greater than that of water.
Yes, cotton will generally float on the surface of water. Cotton is a natural fiber that has a low density and high volume relative to its mass, which causes it to be less dense than water (density of water is approximately 1 gram per cubic centimeter at room temperature). When you place cotton in water, it will not sink but instead disperse on the surface. However, if enough cotton fabric were compacted and folded into a small enough mass with high density, theoretically, it could become heavy enough to sink due to gravity overcoming its buoyancy. But under normal circumstances and for everyday observations, cotton will float in water.
</pre></div>
</div>
</div>
</div>
</section>
<section id="zero-shot">
<h3>Zero Shot<a class="headerlink" href="#zero-shot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>

<span class="n">prompt_string</span> <span class="o">=</span> <span class="s2">&quot;Give me </span><span class="si">{number}</span><span class="s2"> prompt string to generate realistic </span><span class="si">{article_type}</span><span class="s2"> titles.&quot;</span>

<span class="c1">#</span>
<span class="c1"># from_template is a classmethod</span>
<span class="c1"># Returns an instance of PromptTemplate</span>
<span class="n">synthetic_prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">prompt_string</span><span class="p">,</span> <span class="n">template_format</span><span class="o">=</span><span class="s2">&quot;f-string&quot;</span><span class="p">)</span>

<span class="n">synthetic_prompt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PromptTemplate(input_variables=[&#39;article_type&#39;, &#39;number&#39;], template=&#39;Give me {number} prompt string to generate realistic {article_type} titles.&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Is </span><span class="si">{name}</span><span class="s2"> is a planet. Tell me its </span><span class="si">{adjective}</span><span class="s2"> properties&quot;</span><span class="p">,</span> <span class="s2">&quot;Is </span><span class="si">{fname}</span><span class="s2"> is a fruit? Tell me its </span><span class="si">{fadjective}</span><span class="s2"> properties&quot;</span><span class="p">]</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_examples</span><span class="p">(</span><span class="n">examples</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;_next_&quot;</span><span class="p">,</span> <span class="n">input_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;adjective&quot;</span><span class="p">,</span><span class="s2">&quot;fname&quot;</span><span class="p">,</span><span class="s2">&quot;fadjective&quot;</span><span class="p">])</span>
<span class="n">prompt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PromptTemplate(input_variables=[&#39;adjective&#39;, &#39;fadjective&#39;, &#39;fname&#39;, &#39;name&#39;], template=&#39;\n\nIs {name} is a planet. Tell me its {adjective} properties\n\nIs {fname} is a fruit? Tell me its {fadjective} properties\n\n_next_&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="few-shot">
<h2>Few Shot<a class="headerlink" href="#few-shot" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span> <span class="o">=</span><span class="p">[</span> 
    <span class="p">{</span>
    <span class="s2">&quot;context&quot;</span><span class="p">:</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">        A &quot;whatpu&quot; is a small, furry animal native to Tanzania.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;question&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An example of a sentence that uses the word whatpu is:</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;answer&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        We were traveling in Africa and we saw these very cute whatpus.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="p">},</span>
    <span class="p">{</span>
    <span class="s2">&quot;context&quot;</span><span class="p">:</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">        To do a &quot;farduddle&quot; means to jump up and down really fast.</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;question&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An example of a sentence that uses the word farduddle is:</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;answer&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When we won the game, we all started to farduddle in celebration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="p">},</span>  
          <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">FewShotPromptTemplate</span>


<span class="n">example_prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="p">(</span>
    <span class="n">input_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">,</span><span class="s2">&quot;question&quot;</span><span class="p">,</span><span class="s2">&quot;answer&quot;</span><span class="p">]</span>
   <span class="p">,</span><span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;context: </span><span class="si">{context}</span><span class="se">\n</span><span class="s2"> question: </span><span class="si">{question}</span><span class="se">\n</span><span class="si">{answer}</span><span class="s2">&quot;</span>
<span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;********** Single Example ***************&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">example_prompt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">examples</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;********** Print Complete Prompt ***************&quot;</span><span class="p">)</span>

<span class="n">context</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &quot;Bodega&quot; is a slang for small convienience store in new york</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="n">question</span><span class="o">=</span><span class="s2">&quot;make an example sentence that uses Bodega&quot;</span>


<span class="n">fewshot_prompt</span> <span class="o">=</span> <span class="n">FewShotPromptTemplate</span><span class="p">(</span>
    <span class="n">examples</span> <span class="o">=</span> <span class="n">examples</span>
   <span class="p">,</span><span class="n">example_prompt</span> <span class="o">=</span> <span class="n">example_prompt</span>
   <span class="p">,</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;context: </span><span class="si">{context}</span><span class="se">\n</span><span class="s2">question:</span><span class="si">{question}</span><span class="s2">&quot;</span>
   <span class="p">,</span><span class="n">input_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">,</span><span class="s2">&quot;question&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fewshot_prompt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="n">question</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>********** Single Example ***************
context: &quot;
        A &quot;whatpu&quot; is a small, furry animal native to Tanzania.
        
 question: 
        An example of a sentence that uses the word whatpu is:
        

        We were traveling in Africa and we saw these very cute whatpus.
        
********** Print Complete Prompt ***************
context: &quot;
        A &quot;whatpu&quot; is a small, furry animal native to Tanzania.
        
 question: 
        An example of a sentence that uses the word whatpu is:
        

        We were traveling in Africa and we saw these very cute whatpus.
        

context: &quot;
        To do a &quot;farduddle&quot; means to jump up and down really fast.
        
 question: 
        An example of a sentence that uses the word farduddle is:
        

        When we won the game, we all started to farduddle in celebration.
        

context: 
    &quot;Bodega&quot; is a slang for small convienience store in new york
    
question:make an example sentence that uses Bodega
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">fewshot_prompt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="n">question</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;After realizing I forgot my wallet, I hurried to the nearest bodega to quickly grab some essentials before heading back home.&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="algorithimical-optimization-of-llm-prompts">
<h2>Algorithimical Optimization of LLM Prompts<a class="headerlink" href="#algorithimical-optimization-of-llm-prompts" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter3/chapter3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 3 - Pre-train a tiny LLM</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter8.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 8 - LLM Agents Development Ecosystem</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-prompting">Why prompting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-context-learning">In-context learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-shot">Zero Shot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#few-shot">Few Shot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithimical-optimization-of-llm-prompts">Algorithimical Optimization of LLM Prompts</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gopi Subramanian
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>